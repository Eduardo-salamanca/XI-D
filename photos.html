<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Photo Memory - XI-D</title>
    <style>
        /* Previous CSS remains the same until .photo-item */
        .photo-item {
            position: absolute;
            width: 100%;
            height: 100%;
            opacity: 0;
            transition: transform 0.5s ease, opacity 0.5s ease;
            transform: translate(-50%, -50%) translateX(100%);
            top: 50%;
            left: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
            box-sizing: border-box;
            touch-action: pan-y;
            -webkit-overflow-scrolling: touch;
        }

        /* Add this new class */
        .photo-slider.dragging .photo-item {
            transition: none;
        }

        /* Rest of your existing CSS remains the same */
    </style>
</head>
<body class="photos-page">
    <!-- Your existing HTML remains the same until the script tag -->
    
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Create dynamic stars (existing code)
            function createStars() {
                // Your existing createStars function
            }

            // Initialize slider
            const slider = document.querySelector('.photo-slider');
            const items = document.querySelectorAll('.photo-item');
            const prevBtn = document.getElementById('prevBtn');
            const nextBtn = document.getElementById('nextBtn');
            const indicatorsContainer = document.getElementById('indicators');
            const indicators = [];
            let currentIndex = 0;
            let slideInterval;
            let isDragging = false;
            let startPos = 0;
            let currentTranslate = 0;
            let prevTranslate = 0;
            let animationFrameId = null;

            function initSlider() {
                if (items.length === 0) return;
                
                // Initialize first slide
                items[0].classList.add('active');
                createIndicators();
                updateIndicators();
                
                // Touch events
                slider.addEventListener('touchstart', touchStart, { passive: false });
                slider.addEventListener('touchend', touchEnd, { passive: true });
                slider.addEventListener('touchmove', touchMove, { passive: false });
                
                // Mouse events
                slider.addEventListener('mousedown', touchStart);
                window.addEventListener('mouseup', touchEnd);
                window.addEventListener('mousemove', touchMove);
                
                // Button events
                prevBtn.addEventListener('click', () => {
                    goToSlide(currentIndex - 1);
                    resetAutoSlide();
                });
                
                nextBtn.addEventListener('click', () => {
                    goToSlide(currentIndex + 1);
                    resetAutoSlide();
                });
                
                // Start auto-slide
                startAutoSlide();
                
                // Pause auto-slide on hover
                slider.addEventListener('mouseenter', () => clearInterval(slideInterval));
                slider.addEventListener('mouseleave', startAutoSlide);
            }

            function createIndicators() {
                indicatorsContainer.innerHTML = '';
                
                items.forEach((_, index) => {
                    const indicator = document.createElement('div');
                    indicator.className = 'indicator' + (index === 0 ? ' active' : '');
                    indicator.setAttribute('aria-label', `Go to slide ${index + 1}`);
                    indicator.addEventListener('click', (e) => {
                        e.stopPropagation();
                        goToSlide(index);
                        resetAutoSlide();
                    });
                    indicatorsContainer.appendChild(indicator);
                    indicators.push(indicator);
                });
            }

            function updateIndicators() {
                indicators.forEach((indicator, index) => {
                    indicator.classList.toggle('active', index === currentIndex);
                });
            }

            function goToSlide(index) {
                if (items.length === 0) return;
                if (index < 0) index = items.length - 1;
                if (index >= items.length) index = 0;
                if (index === currentIndex) return;

                const direction = index > currentIndex ? 'next' : 'prev';
                
                // Remove transition for smooth animation
                slider.classList.remove('dragging');
                
                // Update current index
                currentIndex = index;
                
                // Update classes for all items
                items.forEach((item, i) => {
                    item.classList.remove('active', 'prev', 'next');
                    
                    if (i === currentIndex) {
                        item.classList.add('active');
                    } else if (i === (currentIndex - 1 + items.length) % items.length) {
                        item.classList.add('prev');
                    } else if (i === (currentIndex + 1) % items.length) {
                        item.classList.add('next');
                    }
                });
                
                updateIndicators();
            }

            function nextSlide() {
                goToSlide(currentIndex + 1);
            }

            function prevSlide() {
                goToSlide(currentIndex - 1);
            }

            function startAutoSlide() {
                clearInterval(slideInterval);
                slideInterval = setInterval(nextSlide, 5000);
            }

            function resetAutoSlide() {
                clearInterval(slideInterval);
                startAutoSlide();
            }

            // Touch and drag handling
            function touchStart(e) {
                if (e.type === 'touchstart' && e.touches.length > 1) {
                    return; // Ignore multi-touch
                }

                isDragging = true;
                startPos = e.type === 'mousedown' ? e.clientX : e.touches[0].clientX;
                slider.classList.add('dragging');
                clearInterval(slideInterval);
                
                // Prevent default to avoid scrolling
                e.preventDefault();
                e.stopPropagation();
            }

            function touchMove(e) {
                if (!isDragging) return;
                
                // Prevent scrolling while dragging
                e.preventDefault();
                e.stopPropagation();
                
                const currentPosition = e.type === 'mousemove' ? e.clientX : e.touches[0].clientX;
                const diff = currentPosition - startPos;
                const activeItem = document.querySelector('.photo-item.active');
                const prevItem = document.querySelector('.photo-item.prev');
                const nextItem = document.querySelector('.photo-item.next');
                
                if (!activeItem) return;
                
                // Move the active slide
                activeItem.style.transform = `translate(calc(-50% + ${diff}px), -50%)`;
                
                // Move adjacent slides
                if (diff > 0 && prevItem) {
                    prevItem.style.transform = `translate(calc(-150% + ${diff}px), -50%)`;
                } else if (diff < 0 && nextItem) {
                    nextItem.style.transform = `translate(calc(50% + ${diff}px), -50%)`;
                }
            }

            function touchEnd(e) {
                if (!isDragging) return;
                
                isDragging = false;
                slider.classList.remove('dragging');
                
                const endPos = e.type === 'mouseup' ? e.clientX : e.changedTouches[0].clientX;
                const diff = endPos - startPos;
                
                // Reset transforms
                document.querySelectorAll('.photo-item').forEach(item => {
                    item.style.transform = '';
                });
                
                // Determine if we should change slides
                if (Math.abs(diff) > 50) { // Minimum swipe distance
                    if (diff > 0) {
                        prevSlide();
                    } else {
                        nextSlide();
                    }
                } else {
                    // If not enough distance, return to current slide
                    goToSlide(currentIndex);
                }
                
                resetAutoSlide();
            }

            function handleKeyDown(e) {
                if (e.key === 'ArrowLeft') {
                    prevSlide();
                    resetAutoSlide();
                } else if (e.key === 'ArrowRight') {
                    nextSlide();
                    resetAutoSlide();
                }
            }

            // Handle window resize
            let resizeTimer;
            window.addEventListener('resize', () => {
                clearTimeout(resizeTimer);
                resizeTimer = setTimeout(() => {
                    // Reset all transforms
                    items.forEach(item => {
                        item.style.transform = '';
                    });
                    // Re-apply current slide
                    goToSlide(currentIndex);
                }, 250);
            });

            // Initialize everything
            createStars();
            initSlider();
            
            // Handle click on indicators
            document.addEventListener('click', (e) => {
                if (e.target.closest('.indicator')) {
                    const index = Array.from(indicators).indexOf(e.target.closest('.indicator'));
                    if (index !== -1) {
                        goToSlide(index);
                        resetAutoSlide();
                    }
                }
            });

            // Prevent default touch actions
            document.addEventListener('touchmove', (e) => {
                if (isDragging) {
                    e.preventDefault();
                }
            }, { passive: false });
        });
    </script>
</body>
</html>
